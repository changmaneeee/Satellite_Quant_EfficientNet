/home/changmin/satellite_efficent/train_nwpu.py:106: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=USE_AMP)
Training on: cuda

--- Loading NWPU Dataset (10 classes) ---
Train loader size: 6000, Test loader size: 1000
Building ResNet with 1-bit quantization and 32-bit activation

--- Training resnet18 on NWPU (1-bit W, 32-bit A, 10 classes) ---
Train Epoch 001/150:   0%|                                                  | 0/188 [00:00<?, ?it/s]/home/changmin/satellite_efficent/train_nwpu.py:38: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
Train Epoch 001/150:   0%|                          | 0/188 [00:08<?, ?it/s, acc=6.25%, loss=2.5255]Train Epoch 001/150:   1%|                  | 1/188 [00:08<27:03,  8.68s/it, acc=6.25%, loss=2.5255]Train Epoch 001/150:   1%|                  | 1/188 [00:17<27:03,  8.68s/it, acc=9.38%, loss=2.8418]Train Epoch 001/150:   1%|▏                 | 2/188 [00:17<26:28,  8.54s/it, acc=9.38%, loss=2.8418]Train Epoch 001/150:   1%|▏                | 2/188 [00:25<26:28,  8.54s/it, acc=10.42%, loss=2.6267]Train Epoch 001/150:   2%|▎                | 3/188 [00:25<26:21,  8.55s/it, acc=10.42%, loss=2.6267]Train Epoch 001/150:   2%|▎                | 3/188 [00:32<26:21,  8.55s/it, acc=10.16%, loss=2.6020]Train Epoch 001/150:   2%|▎                | 4/188 [00:32<24:42,  8.05s/it, acc=10.16%, loss=2.6020]Train Epoch 001/150:   2%|▎                | 4/188 [00:41<24:42,  8.05s/it, acc=10.62%, loss=2.6435]Train Epoch 001/150:   3%|▍                | 5/188 [00:41<24:54,  8.17s/it, acc=10.62%, loss=2.6435]Train Epoch 001/150:   3%|▍                | 5/188 [00:49<24:54,  8.17s/it, acc=10.42%, loss=2.4470]Train Epoch 001/150:   3%|▌                | 6/188 [00:49<25:03,  8.26s/it, acc=10.42%, loss=2.4470]Train Epoch 001/150:   3%|▌                | 6/188 [00:58<25:03,  8.26s/it, acc=10.27%, loss=2.6961]Train Epoch 001/150:   4%|▋                | 7/188 [00:58<24:57,  8.27s/it, acc=10.27%, loss=2.6961]Train Epoch 001/150:   4%|▋                | 7/188 [01:05<24:57,  8.27s/it, acc=11.72%, loss=2.3258]Train Epoch 001/150:   4%|▋                | 8/188 [01:05<23:53,  7.97s/it, acc=11.72%, loss=2.3258]Train Epoch 001/150:   4%|▋                | 8/188 [01:14<23:53,  7.97s/it, acc=11.11%, loss=2.3108]Train Epoch 001/150:   5%|▊                | 9/188 [01:14<24:49,  8.32s/it, acc=11.11%, loss=2.3108]Train Epoch 001/150:   5%|▊                | 9/188 [01:23<24:49,  8.32s/it, acc=10.94%, loss=2.4217]Train Epoch 001/150:   5%|▊               | 10/188 [01:23<25:06,  8.46s/it, acc=10.94%, loss=2.4217]Train Epoch 001/150:   5%|▊               | 10/188 [01:31<25:06,  8.46s/it, acc=11.93%, loss=2.3655]Train Epoch 001/150:   6%|▉               | 11/188 [01:31<25:05,  8.51s/it, acc=11.93%, loss=2.3655]Train Epoch 001/150:   6%|▉               | 11/188 [01:39<25:05,  8.51s/it, acc=12.24%, loss=2.3445]Train Epoch 001/150:   6%|█               | 12/188 [01:39<23:46,  8.10s/it, acc=12.24%, loss=2.3445]